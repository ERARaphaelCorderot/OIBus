<!doctype html>
<html lang="fr" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-guide/advanced/opchda-dcom">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">OPCHDA COM/DCOM setup | OIBus - Data collection solution</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://oibus.optimistik.com//fr/docs/guide/advanced/opchda-dcom"><meta data-rh="true" name="docusaurus_locale" content="fr"><meta data-rh="true" name="docsearch:language" content="fr"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="OPCHDA COM/DCOM setup | OIBus - Data collection solution"><meta data-rh="true" name="description" content="Background"><meta data-rh="true" property="og:description" content="Background"><link data-rh="true" rel="icon" href="/fr/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://oibus.optimistik.com//fr/docs/guide/advanced/opchda-dcom"><link data-rh="true" rel="alternate" href="https://oibus.optimistik.com//docs/guide/advanced/opchda-dcom" hreflang="en"><link data-rh="true" rel="alternate" href="https://oibus.optimistik.com//fr/docs/guide/advanced/opchda-dcom" hreflang="fr"><link data-rh="true" rel="alternate" href="https://oibus.optimistik.com//docs/guide/advanced/opchda-dcom" hreflang="x-default"><link rel="stylesheet" href="/fr/assets/css/styles.24f038a3.css">
<link rel="preload" href="/fr/assets/js/runtime~main.6e0bb503.js" as="script">
<link rel="preload" href="/fr/assets/js/main.39e62fec.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Aller au contenu principal"><a href="#" class="skipToContent_fXgn">Aller au contenu principal</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/fr/"><div class="navbar__logo"><img src="/fr/img/logo.svg" alt="OIBus Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/fr/img/logo.svg" alt="OIBus Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">OIBus</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/fr/docs/guide/">Documentation</a><a class="navbar__item navbar__link" href="/fr/docs/developer/">Developer</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/OptimistikSAS/OIBus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-label="Basculer entre le mode sombre et clair (actuellement mode clair)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Retour au début de la page" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/docs/guide/">Main concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/docs/guide/installation">Installation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/fr/docs/category/engine">Engine</a><button aria-label="Plier/Déplier la catégorie &#x27;Engine&#x27; de la barre latérale" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/fr/docs/category/south-connectors">South connectors</a><button aria-label="Plier/Déplier la catégorie &#x27;South connectors&#x27; de la barre latérale" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/fr/docs/category/north-connectors">North connectors</a><button aria-label="Plier/Déplier la catégorie &#x27;North connectors&#x27; de la barre latérale" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/fr/docs/category/advanced">Advanced</a><button aria-label="Plier/Déplier la catégorie &#x27;Advanced&#x27; de la barre latérale" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/guide/advanced/oibus-security">OIBus security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/guide/advanced/oibus-to-oibus">OIBus to OIBus communication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/guide/advanced/oibus-data-rate">Data rate estimation and cache sizing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/fr/docs/guide/advanced/opchda-dcom">OPCHDA COM/DCOM setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/guide/advanced/opchda-agent">OPCHDA agent</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Fil d&#x27;Ariane"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Page d&#x27;accueil" class="breadcrumbs__link" href="/fr/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/fr/docs/category/advanced"><span itemprop="name">Advanced</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">OPCHDA COM/DCOM setup</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Sur cette page</button></div><div class="theme-doc-markdown markdown"><h1>OPCHDA COM/DCOM setup</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="background">Background<a class="hash-link" href="#background" title="Lien direct vers le titre">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="com">COM<a class="hash-link" href="#com" title="Lien direct vers le titre">​</a></h3><p>COM is the standard protocol for communication between objects located on the same computer but which are part of
different programs. The server is the object providing services, such as making data available. The client is an
application that uses the services provided by the server.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dcom">DCOM<a class="hash-link" href="#dcom" title="Lien direct vers le titre">​</a></h3><p>DCOM represents an expansion of COM functionality to allow access to objects on remote computers. This protocol allows
standardized data exchange between applications from industry, administrative offices and manufacturing. Previously, the
applications that accessed the process data were tied to the access protocols of the communication network. The OPC
standard software interface allows devices and applications from different manufacturers to be combined in a uniform way.</p><p>The OPC client is an application that accesses process data, messages, and archives of an OPC server. Access is through
the OPC software interface. An OPC server is a program that provides standard software interface to read or write data.
The OPC server is the intermediate layer between the applications for handling process data, the various network
protocols and the interfaces for accessing these data. Only devices with operating systems based on Windows COM and
DCOM technology can use the OPC software interface for data exchange.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>DCOM connectivity</div><div class="admonitionContent_S0QG"><p>This page gives some hints on how to set up a communication with COM/DCOM to an OPCHDA server. However, in industrial
context, it is often the responsibility of the IT team to correctly set the permissions, firewall and Windows
configuration.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="windows-settings-client">Windows settings (client)<a class="hash-link" href="#windows-settings-client" title="Lien direct vers le titre">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="client-machine-settings">Client machine settings<a class="hash-link" href="#client-machine-settings" title="Lien direct vers le titre">​</a></h3><p>Follow these steps to enable COM/DCOM communications from the client. First, open the Component services, and access the
<em>Properties</em> of the computer.</p><p><img loading="lazy" alt="Component Services" src="/fr/assets/images/OPCHDA-component-services-e7aac22d92b43939c8342abe1bd6e0cb.png" width="226" height="187" class="img_ev3q"></p><p>Be sure to enable <em>Distributed COM</em> on this computer.</p><p><img loading="lazy" alt="Computer Properties" src="/fr/assets/images/OPCHDA-computer-properties-625a8f6e76f8c90e93bd7d605569aa9d.png" width="373" height="349" class="img_ev3q"></p><p>On the COM Security tab, edit default access permissions.</p><p><img loading="lazy" alt="COM Security" src="/fr/assets/images/OPCHDA-COM-security-cb9d95fd440940efb1d2d8cdfbb299f2.png" width="379" height="381" class="img_ev3q"></p><p>On the Access permissions window, allow the following permissions:</p><ul><li>Local Launch</li><li>Remote Launch</li><li>Local Activation</li><li>Remote Activation</li></ul><p><img loading="lazy" alt="Access Permissions" src="data:image/png;base64,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" width="337" height="105" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-communication">Test communication<a class="hash-link" href="#test-communication" title="Lien direct vers le titre">​</a></h3><p>DCOM uses port 135 of the HDA server to exchange with the client. To do so, it is interesting to use the tnc command of
the Windows Powershell installed as standard. Below, a test that fails (because of the firewall) then a test that
succeeds:</p><p><code>tnc 35.180.44.30 -port 135</code></p><p><img loading="lazy" alt="Test DCOM communication" src="/fr/assets/images/OPCHDA-test-communication-b3414b996a28224ba11df91530555870.png" width="908" height="666" class="img_ev3q"></p><p>If you have a communication problem, see the <a href="#firewall-configuration">firewall configuration section</a> which is probably the source of the problem.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="authentication">Authentication<a class="hash-link" href="#authentication" title="Lien direct vers le titre">​</a></h3><p>An OPCDA client program will communicate with the DA/HDA server with the IP address or hostname of the server followed
by the “progId” of the server. It will then have to be identified at the Windows level with a name and a password which
are (by default) those of the user who launches the client program. This user must therefore be known on the HDA
server as well. You must therefore either:</p><ul><li>Create a user with the same password on the HDA server (assuming it is accessible)</li><li>Be part of the same domain (so the user is accessible from all computers in the domain)</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Important</div><div class="admonitionContent_S0QG"><p>The user must be a member of the <em>Distributed COM Users</em> group</p></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Service</div><div class="admonitionContent_S0QG"><p>If the program runs through a service (such as OIBus), go to the Service manager window, and right-click on the service.
Then click on <em>Launch as user</em>.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="firewall-configuration">Firewall configuration<a class="hash-link" href="#firewall-configuration" title="Lien direct vers le titre">​</a></h3><p>In case of communication issue, the most likely cause is the configuration of a firewall between the two computers
and/or at the hosting company in the case of machines on the cloud. On a Windows server, it is possible to configure
the firewall by adding a rule on port 135.</p><p><img loading="lazy" alt="Windows Firewall Configuration" src="/fr/assets/images/OPCHDA-windows-firewall-a635e64f88cea6c0a2d288aaa329b5f7.png" width="1390" height="785" class="img_ev3q"></p><p>In the case of a server hosted by Lightsail, there is an additional firewall in which a custom rule must be configured
for port 135.</p><p><img loading="lazy" alt="Lightsail Firewall Configuration" src="/fr/assets/images/OPCHDA-lightsail-firewall-56e27e7a446d930e611762f6acc024e2.png" width="908" height="442" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="opcenum-tool">OPCEnum tool<a class="hash-link" href="#opcenum-tool" title="Lien direct vers le titre">​</a></h3><p>The OPC Foundation has provided a tool to allow OPCHDA clients to locate servers on remote nodes, without having
information about those servers in the local registry. This tool is called OPCEnum and is freely distributed by the OPC
Foundation. The PI OPCHDA interface installation installs OPCEnum as well. The primary function of OPCEnum is to inform
or request information from other instances of OPCEnum about existing OPCHDA Servers on the local system. When OPCEnum
is installed, it grants Launch and Access DCOM permission to <em>Everyone</em> and sets the <em>Authentication level</em> to NONE.
This allows access to any user who can log on to the system. The permissions can be changed using <code>dcomcnfg.exe</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="rpc-unavailable">RPC unavailable<a class="hash-link" href="#rpc-unavailable" title="Lien direct vers le titre">​</a></h4><p>If the RPC server is unavailable, try again testing COM/DCOM communication
<a href="#test-communication">testing COM/DCOM communication</a> and check your firewall.</p><p><img loading="lazy" alt="RPC Unavailable" src="/fr/assets/images/OPCHDA-rpc-unavailable-39f6b46627fd092a7d0199d5eb0578b3.png" width="908" height="214" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="access-denied">Access denied<a class="hash-link" href="#access-denied" title="Lien direct vers le titre">​</a></h4><p>Access rights can be diagnosed using the server security log. If the following error happens, check the user and its
password created on the HDA server and that the user is in the <em>Distributed COM Users</em> group on the HDA server.</p><p><img loading="lazy" alt="Access denied" src="/fr/assets/images/OPCHDA-access-denied-8203f722add5f399a9753da6145f9888.png" width="1370" height="732" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="server-settings">Server settings<a class="hash-link" href="#server-settings" title="Lien direct vers le titre">​</a></h2><p>Check on the server machine if DCOM is enabled for the OPC Server application by opening the <em>Component Service</em> window.</p><p><img loading="lazy" alt="Server Machine DCOM Configuration" src="/fr/assets/images/OPCHDA-server-DCOM-configuration-9382bd05033ce686321776a2881ed87a.png" width="435" height="163" class="img_ev3q"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Pagination des documents"><a class="pagination-nav__link pagination-nav__link--prev" href="/fr/docs/guide/advanced/oibus-data-rate"><div class="pagination-nav__sublabel">Précédent</div><div class="pagination-nav__label">Data rate estimation and cache sizing</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/fr/docs/guide/advanced/opchda-agent"><div class="pagination-nav__sublabel">Suivant</div><div class="pagination-nav__label">OPCHDA agent</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#background" class="table-of-contents__link toc-highlight">Background</a><ul><li><a href="#com" class="table-of-contents__link toc-highlight">COM</a></li><li><a href="#dcom" class="table-of-contents__link toc-highlight">DCOM</a></li></ul></li><li><a href="#windows-settings-client" class="table-of-contents__link toc-highlight">Windows settings (client)</a><ul><li><a href="#client-machine-settings" class="table-of-contents__link toc-highlight">Client machine settings</a></li><li><a href="#test-communication" class="table-of-contents__link toc-highlight">Test communication</a></li><li><a href="#authentication" class="table-of-contents__link toc-highlight">Authentication</a></li><li><a href="#firewall-configuration" class="table-of-contents__link toc-highlight">Firewall configuration</a></li><li><a href="#opcenum-tool" class="table-of-contents__link toc-highlight">OPCEnum tool</a></li></ul></li><li><a href="#server-settings" class="table-of-contents__link toc-highlight">Server settings</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/fr/docs/guide/">User Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/fr/docs/developer/">Developer Guide</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/showcase/oibus-by-optimistik" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/OptimistikSAS/OIBus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Optimistik. Built with Docusaurus.</div></div></div></footer></div>
<script src="/fr/assets/js/runtime~main.6e0bb503.js"></script>
<script src="/fr/assets/js/main.39e62fec.js"></script>
</body>
</html>