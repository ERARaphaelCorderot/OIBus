"use strict";(self.webpackChunkdoc_oibus=self.webpackChunkdoc_oibus||[]).push([[6774],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>h});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),u=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},p=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=u(a),m=i,h=d["".concat(l,".").concat(m)]||d[m]||c[m]||r;return a?n.createElement(h,s(s({ref:t},p),{},{components:a})):n.createElement(h,s({ref:t},p))}));function h(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,s=new Array(r);s[0]=m;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[d]="string"==typeof e?e:i,s[1]=o;for(var u=2;u<r;u++)s[u]=a[u];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},9889:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>r,metadata:()=>o,toc:()=>u});var n=a(7462),i=(a(7294),a(3905));const r={sidebar_position:3},s="Data rate estimation and cache sizing",o={unversionedId:"guide/advanced/oibus-data-rate",id:"guide/advanced/oibus-data-rate",title:"Data rate estimation and cache sizing",description:"OIBus facilitates the transmission of values to a target application via North connectors such as OIBus and OIAnalytics,",source:"@site/docs/guide/advanced/oibus-data-rate.md",sourceDirName:"guide/advanced",slug:"/guide/advanced/oibus-data-rate",permalink:"/docs/guide/advanced/oibus-data-rate",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"guideSidebar",previous:{title:"OIBus to OIBus communication",permalink:"/docs/guide/advanced/oibus-to-oibus"},next:{title:"OIBus Agent",permalink:"/docs/category/oibus-agent"}},l={},u=[{value:"Sending files (CSV)",id:"sending-files-csv",level:2},{value:"Row files",id:"row-files",level:3},{value:"Column files",id:"column-files",level:3},{value:"Column row files",id:"column-row-files",level:3},{value:"Sending values (JSON payload)",id:"sending-values-json-payload",level:2},{value:"Format",id:"format",level:3},{value:"Size estimation",id:"size-estimation",level:3}],p={toc:u},d="wrapper";function c(e){let{components:t,...a}=e;return(0,i.kt)(d,(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"data-rate-estimation-and-cache-sizing"},"Data rate estimation and cache sizing"),(0,i.kt)("p",null,"OIBus facilitates the transmission of values to a target application via North connectors such as OIBus and OIAnalytics,\noffering two distinct sending modes:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"File Endpoint"),": Data can be sent by storing it in a file, which is then transferred via the files' endpoint."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"JSON Payloads Endpoint"),": Alternatively, data can be transmitted as JSON payloads using the values' endpoint.")),(0,i.kt)("p",null,"Estimating the appropriate cache size is essential to ensure smooth and reliable store-and-forward operations, and it\ndepends on various factors including the type of data to be sent and the chosen sending mode. Here are some tips for\nestimating the cache size effectively:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Data Volume"),": Analyze the volume of data that your OIBus instance needs to transmit. Consider both the size of individual\ndata elements and the frequency of data updates."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Sending Frequency"),": Evaluate how often data needs to be sent. Frequent transmissions may require larger caches to\naccommodate temporary disruptions in connectivity."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Transmission Mode"),": The chosen sending mode (file or JSON payloads) can impact cache size requirements. JSON\npayloads may consume more memory due to their structured format."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Network Reliability"),": If the network connection to the target application is unreliable or experiences frequent\ninterruptions, a larger cache may be needed to store data during downtime."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Latency Tolerance"),": Consider the acceptable latency between data generation and data delivery to the target\napplication. A larger cache can help mitigate delays caused by network issues."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Retention Policy"),": Determine how long data should be retained in the cache before attempting to resend it. This\nretention period will influence cache size requirements."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Resource Availability"),": Assess the available resources on the OIBus machine, including RAM and storage, as these\nwill impact your ability to allocate a sufficiently sized cache."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Monitoring and Testing"),": Regularly monitor and test your cache system to ensure it meets the actual needs of your\ndata transmission process. Adjust the cache size as necessary based on real-world performance.")),(0,i.kt)("p",null,"By carefully considering these factors, you can make informed decisions about the cache size needed to support efficient\nand reliable data transmission from OIBus to your target application."),(0,i.kt)("h2",{id:"sending-files-csv"},"Sending files (CSV)"),(0,i.kt)("p",null,"Some protocols like SQL can let you organize the data in the resulting file. Here are some tips to understand how it\nimpacts the resulting file size."),(0,i.kt)("p",null,"Based on the provided assumptions, you can calculate the approximate space a CSV file generated by OIBus would\noccupy. Let's break down the key parameters and calculate the file size with the given examples:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Sampling Frequency"),": One point per minute, which means there are 60 data points per hour."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"File Sending Frequency"),": One file sent every 30 minutes, resulting in 2 files per hour."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Timestamp Format"),": ISO 8601 format, 24 bytes in size."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Data Value Format"),": 3 digits with a separator for decimal places, making the data size 4 bytes."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Size of data References"),': Data references are in the format "DataXXX," where XXX represents three numeric characters. Therefore, each reference is 7 bytes in size.')),(0,i.kt)("h3",{id:"row-files"},"Row files"),(0,i.kt)("p",null,"This format is particularly suitable when the different data transmitted do not have the same sampling frequency. In\nthe example we assume that all data has the same sample rate."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csv",metastring:'title="Row file CSV"',title:'"Row',file:!0,'CSV"':!0},"Timestamp                   Reference       Value\n2020-02-01T20:04:00.000Z    Data001         12.0\n2020-02-01T20:04:00.000Z    Data002         10.0\n2020-02-01T20:04:00.000Z    Data003         10.0\n2020-02-01T20:05:00.000Z    Data001         10.0\n2020-02-01T20:05:00.000Z    Data002         19.0\n2020-02-01T20:05:00.000Z    Data003         10.0\n2020-02-01T20:06:00.000Z    Data001         10.0\n2020-02-01T20:06:00.000Z    Data002         10.0\n2020-02-01T20:06:00.000Z    Data003         14.0\n...\n")),(0,i.kt)("p",null,"Now, let's calculate the size of each row file CSV:\n",(0,i.kt)("inlineCode",{parentName:"p"},"Timestamp (24 bytes) + Data Reference (7 bytes) + Data Value (4 bytes) + 3 separators (3 bytes) = 38 bytes")," per data point."),(0,i.kt)("p",null,"For 60 data points per hour, the data size per hour is: ",(0,i.kt)("inlineCode",{parentName:"p"},"38 bytes/data point * 60 data points = 2280 bytes per hour"),"\n(header excluded)."),(0,i.kt)("p",null,"With 2 files sent per hour, the hourly file size would be: ",(0,i.kt)("inlineCode",{parentName:"p"},"2 files/hour * 2100 bytes/file = 4560 bytes per hour"),"."),(0,i.kt)("p",null,"Keep in mind that this calculation provides an estimate based on the specified assumptions, and actual file sizes may\nvary depending on additional factors such as the ",(0,i.kt)("strong",{parentName:"p"},"Data Value Format"),"."),(0,i.kt)("h3",{id:"column-files"},"Column files"),(0,i.kt)("p",null,"This format is especially well-suited for data that shares the same timestamp repeatedly, offering space savings compared\nto a format where each data point is placed on a separate line."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csv",metastring:'title="Column file CSV"',title:'"Column',file:!0,'CSV"':!0},"Timestamp                   Data001     Data002     Data003\n2020-02-01T20:04:00.000Z    12.0        10.0        10.0\n2020-02-01T20:05:00.000Z    10.0        19.0        10.0\n2020-02-01T20:06:00.000Z    10.0        10.0        14.0\n...\n")),(0,i.kt)("p",null,"Let's calculate the size of each column file CSV:\n",(0,i.kt)("inlineCode",{parentName:"p"},"Timestamp (24 bytes) + Data Value (4 bytes) * 3 + 4 separators (4 bytes) = 40 bytes")," per data point."),(0,i.kt)("p",null,"For 60 data points per hour, the data size per hour is: ",(0,i.kt)("inlineCode",{parentName:"p"},"40 bytes/data point * 60 data points = 2400 bytes per hour"),"\n(header excluded)."),(0,i.kt)("p",null,"With 2 files sent per hour, the hourly file size would be: ",(0,i.kt)("inlineCode",{parentName:"p"},"2 files/hour * 2400 bytes/file = 4800 bytes per hour"),"."),(0,i.kt)("h3",{id:"column-row-files"},"Column row files"),(0,i.kt)("p",null,"This format combines the benefits of a column-based file structure and allows for the consolidation of data identifiers\n(001, 002, 003) with their references, although in this case, only ",(0,i.kt)("inlineCode",{parentName:"p"},"Data")," is utilized. This results in references like\n",(0,i.kt)("strong",{parentName:"p"},"Data001"),", ",(0,i.kt)("strong",{parentName:"p"},"Data002"),", and ",(0,i.kt)("strong",{parentName:"p"},"Data003"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-csv",metastring:'title="Column row file CSV"',title:'"Column',row:!0,file:!0,'CSV"':!0},"Timestamp                   Reference   001     002     003\n2020-02-01T20:04:00.000Z    Data        12.0    10.0    10.0\n2020-02-01T20:05:00.000Z    Data        10.0    19.0    10.0\n2020-02-01T20:06:00.000Z    Data        10.0    10.0    14.0\n...\n")),(0,i.kt)("p",null,"Let's calculate the size of each column file CSV:\n",(0,i.kt)("inlineCode",{parentName:"p"},"Timestamp (24 bytes) + Data Reference (4 bytes) + Data Value (4 bytes) * 3 + 5 separators (5 bytes) = 45 bytes")," per\ndata point."),(0,i.kt)("p",null,"For 60 data points per hour, the data size per hour is: ",(0,i.kt)("inlineCode",{parentName:"p"},"45 bytes/data point * 60 data points = 2700 bytes per hour"),"\n(header excluded)."),(0,i.kt)("p",null,"With 2 files sent per hour, the hourly file size would be: ",(0,i.kt)("inlineCode",{parentName:"p"},"2 files/hour * 2700 bytes/file = 5400 bytes per hour"),"."),(0,i.kt)("h2",{id:"sending-values-json-payload"},"Sending values (JSON payload)"),(0,i.kt)("h3",{id:"format"},"Format"),(0,i.kt)("p",null,"When the North connector retrieves values and transmits them to a values' endpoint (OIBus North Connector or OIAnalytics),\nthey are presented in an array format as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="JSON payload"',title:'"JSON','payload"':!0},'[\n    {"timestamp": "2020-02-01T20:04:00.000Z", "pointId":"Data001", "data": {"value": "12.0", "quality": "192"}},\n    {"timestamp": "2020-02-01T20:04:00.000Z", "pointId":"Data002", "data": {"value": "10.0", "quality": "192"}}, \n    {"timestamp": "2020-02-01T20:04:00.000Z", "pointId":"Data003", "data": {"value": "10.0", "quality": "192"}}\n]\n')),(0,i.kt)("p",null,"Each field conveys the following information:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"timestamp"),": denotes the timestamp of the value in ISO 8601 format."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"pointId"),": serves as a reference for the value."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"data"),": a JSON object that encompasses the recorded value (value) and its quality (quality) or other fields.")),(0,i.kt)("p",null,"Our primary focus will be on the data within the JSON file format. In this context, its size is contingent upon various\nparameters, including:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The data sampling frequency."),(0,i.kt)("li",{parentName:"ul"},"The number of points grouped together for transmission (as defined by ",(0,i.kt)("a",{parentName:"li",href:"../north-connectors/common-settings#caching"},"Group Count"),")."),(0,i.kt)("li",{parentName:"ul"},"The frequency of transmission (as defined by ",(0,i.kt)("a",{parentName:"li",href:"../north-connectors/common-settings#caching"},"Send Interval"),")."),(0,i.kt)("li",{parentName:"ul"},"The format of data and quality, specifically the number of characters used for precision."),(0,i.kt)("li",{parentName:"ul"},"The size of the data references.")),(0,i.kt)("h3",{id:"size-estimation"},"Size estimation"),(0,i.kt)("p",null,"It is possible to estimate the space occupied by a single value based on the following criteria:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The timestamp size is 39 bytes (",(0,i.kt)("inlineCode",{parentName:"li"},'"timestamp": "2020-02-01T20:00:00.000Z"'),")."),(0,i.kt)("li",{parentName:"ul"},"The pointId size takes the form of ",(0,i.kt)("inlineCode",{parentName:"li"},'"pointId": "DataXXX"'),', adding 13 bytes to the number of bytes in the reference\n(in this case, 7 bytes for "DataXXX").'),(0,i.kt)("li",{parentName:"ul"},"The data field size is 10 bytes (",(0,i.kt)("inlineCode",{parentName:"li"},'"data": {...}'),"), in addition to its content:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"The value field follows the format ",(0,i.kt)("inlineCode",{parentName:"li"},'"value": "10.0"'),", adding 11 bytes plus the variable number of bytes required to\nencode the value (in this case, 4 bytes)."),(0,i.kt)("li",{parentName:"ul"},"The quality field is of the form ",(0,i.kt)("inlineCode",{parentName:"li"},'"quality": "192"'),", adding 13 bytes plus the variable number of bytes needed to\nencode the quality (here, 3 bytes).")))),(0,i.kt)("p",null,"Therefore, the size of the object representing a value can be broken down as follows:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Constant object size: 39 + 13 + 10 + 11 + 13 + 6 = 92 bytes (6 corresponds to the separators between different elements, such as commas)."),(0,i.kt)("li",{parentName:"ul"},"Size of the reference: 7 bytes"),(0,i.kt)("li",{parentName:"ul"},"Size of the value: 4 bytes"),(0,i.kt)("li",{parentName:"ul"},"Size of the quality: 3 bytes")),(0,i.kt)("p",null,"The total size of a single object to be sent is therefore ",(0,i.kt)("strong",{parentName:"p"},"106 bytes")," for a single value."),(0,i.kt)("p",null,"With a sampling frequency of 1 point per minute and 3 data points, a Group Count equal to 1000, and a Send Interval equal\nto 60000ms, OIBus will transmit a JSON every minute with 3 data points, totaling 318 bytes."),(0,i.kt)("p",null,"Over the course of one day, this would amount to ",(0,i.kt)("inlineCode",{parentName:"p"},"318 x 60 = 19080 bytes"),"."))}c.isMDXComponent=!0}}]);