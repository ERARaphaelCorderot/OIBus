"use strict";(self.webpackChunkdoc_oibus=self.webpackChunkdoc_oibus||[]).push([[7876],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),u=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=u(e.components);return i.createElement(l.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(n),d=a,h=p["".concat(l,".").concat(d)]||p[d]||m[d]||r;return n?i.createElement(h,o(o({ref:t},c),{},{components:n})):i.createElement(h,o({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:a,o[1]=s;for(var u=2;u<r;u++)o[u]=n[u];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},4335:(e,t,n)=>{n.d(t,{ZP:()=>s});var i=n(7462),a=(n(7294),n(3905));const r={toc:[{value:"CSV Serialization",id:"csv-serialization",level:3},{value:"Splitting large queries",id:"splitting-large-queries",level:2}]},o="wrapper";function s(e){let{components:t,...n}=e;return(0,a.kt)(o,(0,i.Z)({},r,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h3",{id:"csv-serialization"},"CSV Serialization"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Filename: The name of the file where the result will be stored. Several internal variable can be used:",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"@ConnectorName: The name of the connector."),(0,a.kt)("li",{parentName:"ul"},"@CurrentDate: The current date in yyyy_MM_dd_HH_mm_ss_SSS format."))),(0,a.kt)("li",{parentName:"ul"},"Delimiter: The delimiter to use in the CSV."),(0,a.kt)("li",{parentName:"ul"},"Compression: Compress the file with gunzip or not."),(0,a.kt)("li",{parentName:"ul"},"Output datetime format: The format of the datetime in the CSV. OIBus will only convert the\n",(0,a.kt)("a",{parentName:"li",href:"#datetime-fields"},"datetime fields")," specified."),(0,a.kt)("li",{parentName:"ul"},"Output timezone: The timezone to use to store the datetime.")),(0,a.kt)("h2",{id:"splitting-large-queries"},"Splitting large queries"),(0,a.kt)("p",null,"In some cases, a query can be quite heavy for the server, especially if a large time interval is requested. If\n@StartTime and @EndTime ",(0,a.kt)("a",{parentName:"p",href:"#query-variables"},"query variables")," are used, the query can be split in several sub-queries\nwith smaller intervals using the ",(0,a.kt)("strong",{parentName:"p"},"Max read interval")," field of ",(0,a.kt)("a",{parentName:"p",href:"/docs/guide/south-connectors/common-settings#history-settings"},"history settings"),"."))}s.isMDXComponent=!0},9273:(e,t,n)=>{n.d(t,{ZP:()=>l});var i=n(7462),a=(n(7294),n(3905)),r=n(4335);const o={toc:[{value:"Item settings",id:"item-settings",level:2},{value:"Query",id:"query",level:3},{value:"Query variables",id:"query-variables",level:4},{value:"Example",id:"example",level:4},{value:"Datetime fields",id:"datetime-fields",level:3}]},s="wrapper";function l(e){let{components:t,...n}=e;return(0,a.kt)(s,(0,i.Z)({},o,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"item-settings"},"Item settings"),(0,a.kt)("h3",{id:"query"},"Query"),(0,a.kt)("p",null,"The query fields accept SQL syntax and can use several internal variables. These variables are useful for data stream\nresilience on connection failure, and to cut big intervals into smaller chunks, reducing the load on the serve and network\n(see ",(0,a.kt)("a",{parentName:"p",href:"#splitting-large-queries"},"the big queries section"),"."),(0,a.kt)("h4",{id:"query-variables"},"Query variables"),(0,a.kt)("p",null,"Several OIBus variables can be used and will be interpreted by OIBus."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"@StartTime"),": The @StartTime variable initially takes the date of the first execution of the query. When results are\nretrieved from the database, @StartTime value is set to the most recent timestamp among those results in the field used\nas reference (see ",(0,a.kt)("a",{parentName:"li",href:"#datetime-fields"},"the datetime fields section"),")."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"@EndTime"),": The @EndTime variable is set to the current time (",(0,a.kt)("em",{parentName:"li"},"now()"),") or to the end of the sub-interval if a query is split.")),(0,a.kt)("h4",{id:"example"},"Example"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT reference, value, timestamp FROM table WHERE timestamp > @StartTime AND timestamp < @EndTime\n")),(0,a.kt)("h3",{id:"datetime-fields"},"Datetime fields"),(0,a.kt)("p",null,"You can specify in this array which fields are a datetime type, and which format to use."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Field name"),": The field name in the SELECT section of the query."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Reference field"),": Use this field as reference for the next @StartTime value (see ",(0,a.kt)("a",{parentName:"li",href:"#query-variables"},"query variables"),")."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Type"),": The type of the data in the result."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Timezone")," (for string, Date, DateTime, DateTime2, SmallDateTime types): The timezone of the datetime stored in the\ndatabase."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Format")," (for string only): The string format of the datetime stored in the database."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Locale")," (for string only): The locale to use when the format contains locale specific string (such as MMM format for\nmonths).")),(0,a.kt)("p",null,"OIBus will internally use these dates in ISO UTC format. The output datetime format can be set in the\n",(0,a.kt)("a",{parentName:"p",href:"#serialization"},"serialization section"),"."),(0,a.kt)(r.ZP,{mdxType:"SerializationSettings"}))}l.isMDXComponent=!0},1675:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var i=n(7462),a=(n(7294),n(3905)),r=n(9273);const o={sidebar_position:14},s="ODBC",l={unversionedId:"guide/south-connectors/odbc",id:"guide/south-connectors/odbc",title:"ODBC",description:"Send SQL queries to a local ODBC driver or to a remote OIBus Agent that can manage ODBC queries on the same machine as",source:"@site/docs/guide/south-connectors/odbc.mdx",sourceDirName:"guide/south-connectors",slug:"/guide/south-connectors/odbc",permalink:"/docs/guide/south-connectors/odbc",draft:!1,tags:[],version:"current",sidebarPosition:14,frontMatter:{sidebar_position:14},sidebar:"guideSidebar",previous:{title:"OIAnalytics (Rest API)",permalink:"/docs/guide/south-connectors/oianalytics"},next:{title:"History queries",permalink:"/docs/guide/history-queries"}},u={},c=[{value:"Specific settings",id:"specific-settings",level:2},{value:"Driver Installation",id:"driver-installation",level:3},{value:"Using OIBus with IP21",id:"using-oibus-with-ip21",level:3}],p={toc:c},m="wrapper";function d(e){let{components:t,...n}=e;return(0,a.kt)(m,(0,i.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"odbc"},"ODBC"),(0,a.kt)("p",null,"Send SQL queries to a local ODBC driver or to a remote OIBus Agent that can manage ODBC queries on the same machine as\nthe server."),(0,a.kt)("p",null,"The OIBus agent can be installed separately, as specified in its ",(0,a.kt)("a",{parentName:"p",href:"../oibus-agent/installation"},"documentation"),"."),(0,a.kt)("h2",{id:"specific-settings"},"Specific settings"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Use remote agent"),": If no, be sure to have an ODBC ",(0,a.kt)("a",{parentName:"li",href:"#driver-installation"},"driver installed")," on the machine where\nOIBus is installed. Otherwise, you can ",(0,a.kt)("a",{parentName:"li",href:"../oibus-agent/installation"},"install an OIBus agent")," on a remote machine\nwith the appropriate drivers."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Remote agent URL"),": The URL of the remote OIBus agent (for example ",(0,a.kt)("inlineCode",{parentName:"li"},"http://ip-adress-or-host:2224"),")"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Connection string"),": The ODBC connection string"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Password"),": The password used for authentication. It is stored securely in OIBus configuration. If put directly in the\nconnection string, the password will be stored in plaintext. When a password is used, OIBus add ",(0,a.kt)("inlineCode",{parentName:"li"},"PWD=<password>")," at the\nend of the connection string."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Connection timeout"),": Timeout on connection"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Request timeout"),": Timeout for each query")),(0,a.kt)("p",null,"The ODBC connection string must respect the driver format. Be sure to have installed the driver specified in the\nconnection string."),(0,a.kt)("admonition",{title:"ODBC connection string example",type:"tip"},(0,a.kt)("p",{parentName:"admonition"},(0,a.kt)("inlineCode",{parentName:"p"},"Driver={driver};SERVER=localhost,10014;TrustServerCertificate=yes;Database=test;UID=oibus;PWD=<secret>")),(0,a.kt)("p",{parentName:"admonition"},"The driver is either the name of the driver (Windows) or the path of the driver file (unix like systems).\nThe port is optional, and can be replaced by ",(0,a.kt)("inlineCode",{parentName:"p"},"PORT=10014")," (be sure to replace the comma ",(0,a.kt)("inlineCode",{parentName:"p"},",")," by a semicolon ",(0,a.kt)("inlineCode",{parentName:"p"},";"),").")),(0,a.kt)("h3",{id:"driver-installation"},"Driver Installation"),(0,a.kt)("p",null,"On Windows, you can directly access the ODBC driver management tool. You can then specify the name of the driver in the\nconnection string (for example ",(0,a.kt)("inlineCode",{parentName:"p"},"MySQL ODBC 3.51 driver")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"SQL Server"),"...)."),(0,a.kt)("p",null,"On UNIX like systems, install it on your machine and specify the path of the driver in the connection string (for example:\n",(0,a.kt)("inlineCode",{parentName:"p"},"/opt/lib/libmsodbcsql.18.dylib"),")"),(0,a.kt)("h3",{id:"using-oibus-with-ip21"},"Using OIBus with IP21"),(0,a.kt)("p",null,"ODBC connections are often laggy. With large historian queries, specially with IP21, it can overload both the network\nand the server."),(0,a.kt)("p",null,"We suggest to install the OIBus Agent as a service on the same machine as IP21. OIBus send the query to its agent with\nthe HTTP protocol, and the agent communicate directly to IP21 with ODBC, without any network latency."),(0,a.kt)("p",null,"Of course, the appropriate ODBC driver must be installed on the agent machine, and this driver must be specified in\nthe connection string."),(0,a.kt)("admonition",{title:"IP21 ODBC driver",type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"You can connect to IP21 through ODBC with the driver ",(0,a.kt)("inlineCode",{parentName:"p"},"AspenTech SQLplus"),". Be sure it is installed on your machine")),(0,a.kt)("admonition",{title:"ODBC Access",type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"The authentication can be pass through the connection string, but it can also be done locally, as with IP21. If so, be sure\nthe OIBus agent run with the correct permission. Maybe run the service as another user, from the service management windows.")),(0,a.kt)("p",null,"The following connection string works with a basic IP21 installation: ",(0,a.kt)("inlineCode",{parentName:"p"},'Driver={AspenTech SQLplus};HOST=<host>;PORT=10014"')),(0,a.kt)(r.ZP,{mdxType:"ItemSettings"}))}d.isMDXComponent=!0}}]);